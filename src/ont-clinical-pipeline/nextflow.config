profiles {
    aws {
        process.executor = 'awsbatch'
        process.queue = 'my-ngs-batch-queue' 
        workDir = 's3://ngs-variant-validator-work'
        aws.region = 'us-east-1'
    }
}

process {
    // Python processes
    withName: 'FETCH_DB_INPUTS|LOG_DB_OUTPUTS|PARSE_INPUTS|FILTER_BY_COVERAGE|GENERATE_JSON_REPORT' {
        container = 'python:3.9-slim'
    }
    
    // Database credentials specifically for the I/O scripts
    withName: 'FETCH_DB_INPUTS|LOG_DB_OUTPUTS' {
        ext.db_host = secrets.DB_HOST
        ext.db_user = secrets.DB_USER
        ext.db_pass = secrets.DB_PASSWORD
        ext.db_name = secrets.DB_NAME
    }

    // Bioinformatics processes using Biocontainers
    withName: 'ALIGN_READS' {
        container = 'quay.io/biocontainers/minimap2:2.26--he4a0461_2'
    }
    withName: 'CALCULATE_COVERAGE' {
        container = 'quay.io/biocontainers/mosdepth:0.3.3--hdfd78af_1'
    }
    withName: 'CALL_VARIANTS' {
        container = 'quay.io/biocontainers/deepvariant:1.6.0' // Placeholder for modern ONT caller
    }
    withName: 'ANNOTATE_VARIANTS' {
        container = 'quay.io/biocontainers/snpeff:5.1--hdfd78af_2' // Placeholder for annotation
    }
}